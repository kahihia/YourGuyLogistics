/*! Vendor-Webaap - v0.0.0 - 2016-01-09 */
!function(){"use strict";var a=function(a,b,c,d){this.loader=!1,this.userLogin=function(){this.loader=!0;var e=this,f={username:this.username,password:this.password};b.login(f).then(function(b){c.token=b.data.auth_token,d.$refresh().then(function(b){b.$updateuserRole(),a.go("home")})},function(a){e.loader=!1,e.error_message=a.data.non_field_errors[0]})}};angular.module("login",[]).config(["$stateProvider",function(a){a.state("login",{url:"/login",templateUrl:"/static/modules/login/login.html",controllerAs:"login",controller:"LoginCntrl",resolve:{vendorClients:"vendorClients",access:["Access",function(a){return a.isAnonymous()}]}})}]).controller("LoginCntrl",["$state","AuthService","$localStorage","vendorClients",a])}(),function(){"use strice";var a=function(a,b){return{login:function(c){return a.post(b.v1baseUrl+"auth/login/",c)}}};angular.module("login").factory("AuthService",["$http","constants",a])}(),function(){"use strict";var a=function(a,b,c,d,e){
// Redirect to admin or vendor page accorfing to the credentials.
e.$hasRole(d.userRole.ADMIN)?(this.admin=!0,a.go("home.opsorder")):e.$hasRole(d.userRole.VENDOR)&&(this.vendor=!0,a.go("home.order"));
// Controller logic for common items between vendor and admin.
var f=this;this.store_name=e.store_name;var g=c.confirm().parent(angular.element(document.querySelector("#body"))).clickOutsideToClose(!1).title("Are you sure you want to Sign Out?").textContent("After this you will be redirected to login page.").ariaLabel("Sign Out").targetEvent().ok("Sign Out!").cancel("Not Now").openFrom("#logout-button").closeTo("#logout-button");this.toggleSideNav=function(){b("left").toggle()},this.logout=function(){e.$clearUserRole(),e.$refresh().then(function(b){a.go("login")})},this.showLogoutDialog=function(){c.show(g).then(function(){f.logout()})}};angular.module("home",[]).config(["$stateProvider",function(a){a.state("home",{url:"/home",templateUrl:"/static/modules/home/home.html",controllerAs:"home",controller:"homeCntrl",resolve:{vendorClients:"vendorClients",access:["Access",function(a){return a.isAuthenticated()}]}})}]).controller("homeCntrl",["$state","$mdSidenav","$mdDialog","constants","vendorClients",a])}(),function(){"use strict";var a=function(a,b,c){};angular.module("forbidden",[]).config(["$stateProvider",function(a){a.state("forbidden",{url:"/forbidden",templateUrl:"/static/modules/forbidden/forbidden.html",controllerAs:"forbidden",controller:"forbiddenCntrl"})}]).controller("forbiddenCntrl",["$state",a])}(),function(){"use strict";
// Declare all the app level modules which depend on the different filters and services
angular.module("ygVendorApp",["ngMaterial","ngMessages","ui.router","ngStorage","ngResource","base64","login","home","order","forbidden"]).config(["$urlRouterProvider","$locationProvider","$mdThemingProvider","roleProvider",function(a,b,c,d){
// For any unmatched url, redirect to /home
a.otherwise("/home"),b.html5Mode(!0).hashPrefix("!"),d.$get().$setUserRole(),c.theme("purpleTheme").primaryPalette("purple").accentPalette("blue").warnPalette("deep-orange"),c.setDefaultTheme("purpleTheme")}])}(),function(){"use strice";var a={role:"",token:""};angular.module("ygVendorApp").constant("UserData",a)}(),function(){"use strice";var a={v1baseUrl:"/api/v1/",v2baseUrl:"/api/v2/",v3baseUrl:"/api/v3/",userRole:{ADMIN:"operations",VENDOR:"vendor"}};angular.module("ygVendorApp").constant("constants",a)}(),function(){"use strict";var a=function(a,b){var c={OK:200,UNAUTHORIZED:401,FORBIDDEN:403,hasRole:function(d){var e=a.defer();return b.then(function(a){a.$hasRole(d)?e.resolve(c.OK):a.$isAnonymous()?e.reject(c.UNAUTHORIZED):e.reject(c.FORBIDDEN)}),e.promise},isAuthenticated:function(){var d=a.defer();return b.then(function(a){a.$isAuthenticated()?d.resolve(c.Ok):d.reject(c.UNAUTHORIZED)}),d.promise},isAnonymous:function(){var d=a.defer();return b.then(function(a){a.$isAnonymous()?d.resolve(c.OK):d.reject(c.FORBIDDEN)}),d.promise}};return c};angular.module("ygVendorApp").factory("Access",["$q","vendorClients",a])}(),function(){"use strict";var a=function(a,b){return{getOrders:a(b.v2baseUrl+"order/:id/",{id:"@id"},{query:{method:"GET",isArray:!1}})}};angular.module("ygVendorApp").factory("Order",["$resource","constants",a])}(),function(){"use strict";var a=function(a,b){return a(b.v1baseUrl+"vendor/:id",{id:"@id"},{profile:{method:"GET"},query:{method:"GET",isArray:!1,transformResponse:function(a){var b=angular.fromJson(a);if(angular.isArray(b)){var c={};return c.store_name="Operations",c.vendors=b,c}return b}}})};angular.module("ygVendorApp").factory("Vendor",["$resource","constants",a])}(),function(){"use strict";var a=function(a,b,c){var d={responseError:function(d){var e=a.defer();return(401===d.status||403===d.status)&&(b.$reset(),c.path("/login")),e.reject(d),e.promise}};return d},b=function(a,b,c){a.$on("$stateChangeError",function(a,d,e,f,g,h){console.log(h),h==b.UNAUTHORIZED?c.go("login"):h==b.FORBIDDEN&&c.go("forbidden")})};angular.module("ygVendorApp").factory("errorHandler",["$q","$localStorage","$location",a]).config(["$httpProvider",function(a){a.interceptors.push("errorHandler")}]).run(["$rootScope","Access","$state",b])}(),function(){"use strict";var a=function(a){var b={request:function(b){return b.headers=b.headers||{},a.token&&(b.headers.Authorization="Token "+a.token),b}};return b};angular.module("ygVendorApp").factory("tokenInjector",["$localStorage",a]).config(["$httpProvider",function(a){a.interceptors.push("tokenInjector")}])}(),function(){"use strice";var a=function(a,b){var c={userrole:"anonymous",authenticated:!1,$resetUserRole:function(){return b.$reset(),userrole="anonymous",authenticated=!1,{userrole:userrole,is_authenticated:authenticated}},$setUserRole:function(){if(b.token){var c=a.decode(b.token).split(":");userrole=c[1],authenticated=!0}else userrole="anonymous",authenticated=!1},$getUserRole:function(){return{userrole:userrole,is_authenticated:authenticated}}};return c};angular.module("ygVendorApp").factory("role",["$base64","$localStorage",a])}(),function(){"use strict";var a=function(a,b,c){var d={},e=function(){var f=a.defer();return c.query(function(a){f.resolve(angular.extend(d,a,{$refresh:e,$updateuserRole:function(){return b.$setUserRole()},$clearUserRole:function(){return b.$resetUserRole()},$hasRole:function(a){return b.$getUserRole().userrole==a},$isAuthenticated:function(){return b.$getUserRole().is_authenticated},$isAnonymous:function(){return!b.$getUserRole().is_authenticated}}))},function(a){f.resolve(angular.extend(d,{$refresh:e,$updateuserRole:function(){return b.$setUserRole()},$clearUserRole:function(){return b.$resetUserRole()},$hasRole:function(a){return $getUserRole().userrole==a},$isAuthenticated:function(){return b.$getUserRole().is_authenticated},$isAnonymous:function(){return!b.$getUserRole().is_authenticated}}))}),f.promise};return e()};angular.module("ygVendorApp").factory("vendorClients",["$q","role","Vendor",a])}(),function(){"use strict";var a=function(a,b,c,d,e){console.log(e),this.orders=e.data,this.total_pages=e.total_pages,this.total_orders=e.total_orders,this.pending_orders_count=e.pending_orders_count,this.unassigned_orders_count=e.unassigned_orders_count,this.toggleFilter=function(){b("order-filter").toggle()}},b=function(a){console.log("vendor")};angular.module("order",[]).config(["$stateProvider",function(a){a.state("home.opsorder",{url:"^/all-orders",templateUrl:"/static/modules/order/opsOrders.html",controllerAs:"opsOrder",controller:"opsOrderCntrl",resolve:{vendorClients:"vendorClients",orderResource:"Order",access:["Access","constants",function(a,b){return a.hasRole(b.userRole.ADMIN)}],orders:["Order","$stateParams",function(a,b){return a.getOrders.query(b).$promise}]}}).state("home.order",{url:"^/orders",templateUrl:"/static/modules/order/vendorOrders.html",controllerAs:"order",controller:"vendorOrderCntrl",resolve:{vendorClients:"vendorClients",access:["Access","constants",function(a,b){return a.hasRole(b.userRole.VENDOR)}]}})}]).controller("opsOrderCntrl",["$state","$mdSidenav","vendorClients","orderResource","orders",a]).controller("vendorOrderCntrl",["$state",b])}();
//# sourceMappingURL=main.min.js.map